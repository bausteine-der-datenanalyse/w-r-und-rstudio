{
  "hash": "c7a2004857104714175836a7eea8143d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Dichtekurven und Normalverteilung\"\n---\n\n\n::: {.cell}\n\n:::\n\n\n\n## Übersicht Dataframes für diese Folien\n\n<br/><br/>\n\n| Name     | Inhalt                                  |\n|----------|-----------------------------------------|\n| `d_ns_m` | Monatswerte für Niederschläge in Bochum |\n\n<br/><br/>\n\nQuellen: <https://www.dwd.de>\n\n\n# Normalverteilung\n\n\n## Exkurs: Funktionen erzeugen {.smaller}\n\n### Eigene Funktionen\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf1 <- function(x) x^2\nf1(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4\n```\n\n\n:::\n:::\n\n\n- Funktion `f1` berechnet `x^2`\n- Dabei ist `function(x) x^2` die Funktion mit dem Namen `f1`\n\n### Normalverteilung mit $\\mu = 1$ und $\\sigma = 2$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf2 <- function(x) dnorm(x, mean = 1, sd = 2)\nf2(0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1760327\n```\n\n\n:::\n:::\n\n\n- Funktion `f2` berechnet mit `dnorm(x, mean = mu, sd = sigma)` Normalverteilung\n- an der Stelle x\n- mit Mittelwert `mu` und Standardabweichung `sigma`\n\n\n## Funktion plotten mit `geom_function()`\n\n::::: columns\n::: {.column width=\"50%\"}\n\n### Beispiel 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf1 <- function(x) x^2\nggplot() +\n  geom_function(fun = f1)\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- `geom_function()` plottet Kurve ohne Mapping\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n### Beispiel 2\n\n::: {.cell}\n\n```{.r .cell-code}\nf2 <- function(x) dnorm(x, mean = 1, sd = 2)\nggplot() +\n  geom_function(fun = f2)\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-5-1.pdf){fig-pos='H'}\n:::\n:::\n\n- Funktion angeben mit `fun = <Funktion>`\n\n:::\n:::::\n\n## Plotbereich festlegen\n\nDie beiden Beispielfunktionen sehen nicht so charakteristisch aus wie wir es gewohnt sind. Dafür müssen wir den Bereich festlegen, der uns angezeigt wird.\n\n##\n\n\n### Erste Möglichkeit\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = tibble(A = c(-1, 1), B = c(1, 1))) +\n  geom_function(fun = f1) + geom_point(mapping = aes(x = A, y = B))\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Plotbereich aus zweitem Geom (zum Beispiel Punkte)\n\n##\n\n### Zweite Möglichkeit\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_function(fun = f2, xlim = c(-8, 10))\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Mit `xlim` explizit angeben\n- xlim wie limits = Grenzen für die x-Werte\n\n\n## Funktion plotten mit `geom_ribbon()` {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_ribbon(\n    mapping = aes(x = after_stat(x), ymin = 0, ymax = after_stat(y)),\n    stat='function', fun=f2, xlim = c(-8, 10), color='black', fill='linen', alpha=0.8\n  )\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Mapping mit `x` und `y` aus `stat = 'function'` mit `after_stat(x)` und `after_stat(y)`\n\n\n## Histogramm mit Normalverteilung Niederschläge\n\n[]{.down40}\n\n### Mittelwert und Standardabweichung der Stichprobe berechnen\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- mean(d_ns_m$Niederschlag)\nsigma <- sd(d_ns_m$Niederschlag)\n```\n:::\n\n\n### Funktion `f` für Normalverteilung x mit `mu` und `sigma`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf <- function(x) dnorm(x, mean=mu, sd=sigma)\n```\n:::\n\n\n### Plot in Variable `p` speichern (für nächste Folie)\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- ggplot(data = d_ns_m) +\n  geom_histogram(mapping = aes(x = Niederschlag, y = stat(density)), binwidth = 5, boundary = 0) +\n  geom_line(stat = 'function', fun = f, color = 'red', linewidth = 1)\n```\n:::\n\n\n\n## Histogramm mit Normalverteilung\n\n\n::: {.cell}\n\n```{.r .cell-code}\np\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: `stat(density)` was deprecated in ggplot2 3.4.0.\ni Please use `after_stat(density)` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-12-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n## Kontrolle: Normal-Quantil-Plot {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m) +\n  geom_qq(mapping = aes(sample = Niederschlag)) + \n  geom_qq_line(mapping = aes(sample = Niederschlag))\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-13-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Normal-Quantil-Plot mit `geom_qq()` sowie `geom_qq_line()`\n- geom_qq_line ist die Linie, geom_qq sind die Punkte\n- Ergebnis: Normalverteilung nicht gut geeignet, Verteilung der Daten ist rechtsschief\n\n\n## Kontrolle: Normal-Quantil-Plot {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m, mapping = aes(sample = Niederschlag)) +\n  geom_qq() + \n  geom_qq_line()\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-14-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Mapping für alle Geoms gleich?\n- Dann als Argument in `ggplot()`\n\n\n# 2. Approximierte Dichtefunktionen\n\n\n## Dichtefunktion Niederschläge {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m) +\n  geom_histogram(mapping = aes(x = Niederschlag, y = stat(density)), binwidth = 10, boundary = 0) +\n  geom_density(mapping = aes(x = Niederschlag), color = 'red', linewidth = 1) +\n  lims(x = c(-50, 250))\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-15-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- `geom_density()` erzeugt approximierte Dichtefunktion\n- Größerer Plotbereich mit `lims(x = c(xmin, xmax))` (Details später)\n\n\n## Dichtefunktion Niederschläge {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m) +\n  geom_histogram(mapping = aes(x = Niederschlag, y = stat(density)), binwidth = 10, boundary = 0) +\n  geom_density(mapping = aes(x = Niederschlag), color = 'red', linewidth = 1, fill = 'linen', alpha = 0.8) +\n  lims(x = c(-50, 250))\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-16-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Fläche füllen mit `fill = <Farbe>`\n- Transparenz mit `alpha = <Wert>`\n\n\n## Dichtefunktion Niederschläge {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m) +\n  geom_histogram(mapping = aes(x = Niederschlag, y = stat(density)), binwidth = 10, boundary = 0) +\n  geom_density(mapping = aes(x = Niederschlag), bw = 2, linewidth = 1, color = 'orange') +\n  geom_density(mapping = aes(x = Niederschlag), bw = 4, linewidth = 1, color = 'blue') +\n  geom_density(mapping = aes(x = Niederschlag), bw = 8, linewidth = 1, color = 'red') + \n  lims(x = c(-50,250))\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-17-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Argument `bw = <Wert>` legt die Breite des Kerns fest (bw = *bandwidth*)\n- Je größer `bw` umso glatter die Kurve\n\n\n## Dichtefunktion in Monaten {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m) +\n  geom_density(mapping = aes(x = Niederschlag, fill = Monat), alpha = 1/4)\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-18-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Füllfarbe nach Monat\n- Transparenz mit `alpha = <Wert>`\n\n\n## Dichtefunktionen untereinander {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m) +\n  geom_density_ridges(mapping = aes(x = Niederschlag, y = Monat), bandwidth = 10)\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-19-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Geom `geom_density_ridges()` wie `geom_density()` aber untereinander\n- Kernbreite mit `bandwidth = <Wert>` angeben\n- Paket `ggridges` installieren\n\n\n## Violinenplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m) +\n  geom_violin(mapping = aes(x = 0, y = Niederschlag))\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-20-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Ähnlich Boxplot, aber mit Kurven\n\n\n## Violinenplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = d_ns_m) +\n  geom_violin(mapping = aes(x = Monat, y = Niederschlag))\n```\n\n::: {.cell-output-display}\n![](dichtekurven_files/figure-pdf/unnamed-chunk-21-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n- Monate besitzen unterschiedliche Charakteristiken\n\n\n# Zusammenfassung\n\n\n## Funktionen definieren\n\n### Normale Funktion\n\n\n::: {.cell}\n\n```{.r .cell-code}\nf <- function(x) sin(x^2)\n```\n:::\n\n\n### Normalverteilung\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu <- mean(<Vektor>)\nsigma <- sd(<Vektor>)\nf <- function(x) dnorm(x, mu, sigma)\n```\n:::\n\n\n\n## Funktionen plotten {.smaller}\n\n### Mit `geom_function()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_function(stat = 'function', fun = <Funktion>, xlim = c(<from>, <to>), Argumente)\n```\n:::\n\n\n- Funktion vorab definieren\n- Plotbereich mit `xlim` festlegen\n- Argumente für `geom_line`(Verweis zu Basics, \"Was sind Argumente?\")\n\n### Mit `geom_ribbon()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_ribbon(\n    mapping = aes(x = after_stat(x), ymin = 0, ymax = after_stat(y)),\n    stat = 'function', fun = <Funktion>, xlim = c(<from>, <to>), Argumente\n  )\n```\n:::\n\n\n- Mapping mit Werten, die das Stat berechnet (hier: `x` und `y`)\n- Sonst wie `geom_function()`\n\n\n## Dichtefunktion mit `geom_density()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = <DATAFRAME>) +\n  geom_density(mapping = aes(x = <M>, ...), Argumente)\n```\n:::\n\n\n| AES | Beschreibung       | Optional |\n|-----|--------------------|----------|\n| x   | Merkmal für Dichte | Nein     |\n\n: {tbl-colwidths=\"[20,60,20]\"}\n\n[]{.down20}\n\n| AES/Argumente | Beschreibung              | Optional |\n|---------------|---------------------------|----------|\n| color         | Farbe der Linie           | Ja       |\n| fill          | Füllfarbe                 | Ja       |\n| alpha         | Transparenz der Füllfarbe | Ja       |\n\n: {tbl-colwidths=\"[20,60,20]\"}\n\nAesthetics und Argumente synonym verwendet, sinnvoll?\n\n[]{.down20}\n\n| Argumente | Beschreibung                                              | Optional |\n|-----------|-----------------------------------------------------------|----------|\n| kernel    | Art des Kerns ('gaussian', 'epanechnikov', 'cosine', ...) | Ja       |\n| bw        | Glättungsbreite h                                         | Ja       |\n\n: {tbl-colwidths=\"[20,60,20]\"}\n\n→ Nicht genau dieselben Kerne, wie in der Vorlesung\n\n\n## Normal-Quantil-Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = <Dataframe>) +\n  geom_qq(mapping = aes(sample = <M>), Argumente) + \n  geom_qq_line(mapping = aes(sample = <M>), Argumente)\n```\n:::\n\n\n[]{.down20}\n\n| AES    | Beschreibung      | Optional |\n|--------|-------------------|----------|\n| sample | Merkmal mit Daten | Nein     |\n\n: {tbl-colwidths=\"[20,50,30]\"}\n\n[]{.down20}\n\n| Argumente | Beschreibung | Optional |\n|-----------|--------------|----------|\n| color     | Farbe        | Ja       |\n\n: {tbl-colwidths=\"[20,50,30]\"}\n\n## Dichtefunktionen untereinander\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = <Dataframe>) +\n  geom_density_ridges(mapping = aes(x = <M>, y = <M>, ...), bandwidth = bw)\n```\n:::\n\n\n| AES | Beschreibung           | Optional |\n|-----|------------------------|----------|\n| x   | Merkmal für Dichte     | Nein     |\n| y   | Merkmal einzelne Plots | Nein     |\n\n: {tbl-colwidths=\"[20,50,30]\"}\n\n[]{.down20}\n\n| AES/Argumente | Beschreibung              | Optional |\n|---------------|---------------------------|----------|\n| color         | Farbe der Linie           | Ja       |\n| fill          | Füllfarbe                 | Ja       |\n| alpha         | Transparenz der Füllfarbe | Ja       |\n\n: {tbl-colwidths=\"[20,50,30]\"}\n\n[]{.down20}\n\n| Argumente | Beschreibung      | Optional |\n|-----------|-------------------|----------|\n| bandwidth | Glättungsbreite h | Ja       |\n\n: {tbl-colwidths=\"[20,50,30]\"}\n\n## Violinenplot\n\n[]{.down120}\n\n→ Wie Boxplot\n",
    "supporting": [
      "dichtekurven_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}