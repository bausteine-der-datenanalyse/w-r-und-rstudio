#| echo: false
#| message: false
library(hms)
library(readxl)
library(tidyverse)
library(kableExtra)
d_uni <- read_excel("daten/unistrasse-2017-2.xlsx", sheet = "raw(T)", range = "B2:H20712")
d_uni
d_uni |> select(-Fahrtrichtung, -ends_with("(Radar)"))
d_uni
d_uni |> select(Datum, Fahrzeug, Geschwindigkeit, "Länge (cm)")
d_uni
d_uni |> select(date = Datum, FZ = Fahrzeug, v = Geschwindigkeit, L = "Länge (cm)")
d_uni
d <- tibble(A_X = 1:2, B_X = 1:2, X_A = 1:2, X_B = 1:2, Datum = 1:2)
d |> kable()
d_uni |> select(Datum, Fahrzeug, Geschwindigkeit, "Länge (cm)")
d_uni |> select(-Fahrtrichtung, -ends_with("(Radar)"))
d_uni |> select(date = Datum, FZ = Fahrzeug, v = Geschwindigkeit, L = "Länge (cm)")
d <- tibble(A_X = 1:2, B_X = 1:2, X_A = 1:2, X_B = 1:2, Datum = 1:2)
d |> kable()
d |> select(starts_with("X")) |> kable()
d |> select(-ends_with("X")) |> kable()
d |> select(ends_with("X")) |> kable()
d |> select(-starts_with("X")) |> kable()
d_uni |> rename(v = Geschwindigkeit)
d_uni |> select(Datum, Fahrzeug, Geschwindigkeit, "Länge (cm)")
d_uni |> filter(Fahrzeug == "LKW") |> select(Datum, Fahrzeug, Geschwindigkeit, "Länge (cm)")
d_unistrasse <- read_excel("daten/unistrasse-2017-2.xlsx",sheet="raw(T)",range="B2:H20712") |>
select(Datum, Fz = Fahrzeug, L = `Länge (cm)`, v = Geschwindigkeit) |>
filter(!is.na(Fahrzeug)) |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
D15 = floor_date(Datum, "15 minutes"),
Uhrzeit = as_hms(Datum)
)
d_unistrasse <- read_excel("daten/unistrasse-2017-2.xlsx",sheet="raw(T)",range="B2:H20712") |>
select(Datum, Fz = Fahrzeug, L = `Länge (cm)`, v = Geschwindigkeit) |>
filter(!is.na(Fz)) |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
D15 = floor_date(Datum, "15 minutes"),
Uhrzeit = as_hms(Datum)
)
d_unistrasse
d_unistrasse <- read_excel("daten/unistrasse-2017-2.xlsx",sheet="raw(T)",range="B2:H20712") |>
select(Datum, Fz = Fahrzeug, L = `Länge (cm)`, v = Geschwindigkeit) |>
filter(!is.na(Fz)) |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
D15 = floor_date(Datum, "15 minutes"),
Uhrzeit = as_hms(Datum)
)
d_unistrasse |> select(Datum, Uhrzeit, D15, Fz, L, v)
ggplot(data = d_unistrasse) +
geom_hex(mapping = aes(x = Uhrzeit, y = Geschwindigkeit))
ggplot(data = d_unistrasse) +
geom_hex(mapping = aes(x = Uhrzeit, y = v))
d_unistrasse <- read_excel("daten/unistrasse-2017-2.xlsx",sheet="raw(T)",range="B2:H20712") |>
select(Datum, Fz = Fahrzeug, L = `Länge (cm)`, v = Geschwindigkeit) |>
filter(!is.na(Fz)) |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
D15 = floor_date(Datum, "15 minutes"),
Uhrzeit = as_hms(Datum)
)
d_unistrasse |> select(Datum, Uhrzeit, D15, Fz, L, v)
ggplot(data = d_unistrasse) +
geom_hex(mapping = aes(x = Uhrzeit, y = v))
d_uni |> mutate(Raser = if_else(v >= 70, "Ja", "Nein"))
d_uni |> mutate(Raser = if_else(Geschwindigkeit >= 70, "Ja", "Nein"))
d_unistrasse <- read_excel("daten/unistrasse-2017-2.xlsx",sheet="raw(T)",range="B2:H20712") |>
select(Datum, Fz = Fahrzeug, L = `Länge (cm)`, v = Geschwindigkeit) |>
filter(!is.na(Fz)) |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
Uhrzeit = as_hms(Datum),
D15 = floor_date(Datum, "15 minutes")
)
d_unistrasse |> select(Datum, Uhrzeit, D15, Fz, L, v)
d_unistrasse <- read_excel("daten/unistrasse-2017-2.xlsx",sheet="raw(T)",range="B2:H20712") |>
select(Datum, Fz = Fahrzeug, L = `Länge (cm)`, v = Geschwindigkeit) |>
filter(!is.na(Fz)) |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
Uhrzeit = as_hms(Datum),
D15 = floor_date(dmy_hms(Datum, tz = "Europe/Berlin"), "15 minutes"),
)
d_unistrasse |> select(Datum, Uhrzeit, D15, Fz, L, v)
d_unistrasse <- read_excel("daten/unistrasse-2017-2.xlsx",sheet="raw(T)",range="B2:H20712") |>
select(Datum, Fz = Fahrzeug, L = `Länge (cm)`, v = Geschwindigkeit) |>
filter(!is.na(Fz)) |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin")
) |>
mutate(
D15     = floor_date(Datum, "15 minutes"),
Uhrzeit = as_hms(Datum)
)
d_unistrasse |> select(Datum, Uhrzeit, D15, Fz, L, v)
d_uni |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
D15 = floor_date(Datum, "15 minutes"),
Uhrzeit = as_hms(Datum)
)
d_uni |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
D15 = floor_date(Datum, "15 minutes"),
Uhrzeit = as_hms(Datum)
) |>
select(Datum, Uhrzeit, D15)
d_unistrasse |> summarise(n = n(), VMit = mean(v), VS = sd(v))
d_unistrasse |>
group_by(Fahrzeug) |>
summarise(n = n(), VMit = mean(v), VS = sd(v))
d_unistrasse |>
group_by(Fz) |>
summarise(n = n(), VMit = mean(v), VS = sd(v))
d_unistrasse_15m <- d_unistrasse |>
group_by(D15) |>
summarise(VMit = mean(v))
ggplot(data = d_unistrasse_15m, mapping = aes(x = D15, y = VMit)) + geom_line() + geom_point()
d_unistrasse |> group_by(Fz) |> str()
d_unistrasse |> select(-D15) |>
group_by(Fz) |>
filter(v == max(v)) |>
kable()
d_unistrasse |> select(-D15) |>
group_by(Fz) |>
filter(Geschwindigkeit == max(v)) |>
kable()
d_unistrasse |> select(-D15) |>
group_by(Fz) |>
filter(v == max(v)) |>
kable()
d_uni |> arrange(Geschwindigkeit, Fahrzeug) |> select(Datum, Fahrzeug, v = Geschwindigkeit)
d_uni |> mutate(V10 = signif(Geschwindigkeit, digits = 1))|> select(Datum, Fahrzeug, v = Geschwindigkeit, V10)
install.packages("hms")
d_uni |>
mutate(
Datum = dmy_hms(Datum, tz = "Europe/Berlin"),
Uhrzeit = as_hms(Datum)
) |> select(Datum, Uhrzeit, Fahrzeug, v = Geschwindigkeit)
d_uni |> mutate(Raser = if_else(Geschwindigkeit >= 70, "Ja", "Nein")) |> select(Datum, Fahrzeug, v = Geschwindigkeit, Raser)
d_unistrasse |> str()
d_energietraeger <-
read_excel("daten/energiedaten-gesamt-xls.xlsx", sheet="4", range="A8:AC17") |>
pivot_longer(!Energieträger, names_to = "Jahr", values_to = "Verbrauch") |>
mutate(Jahr = as.numeric(Jahr))
ggplot(data = d_energietraeger) +
geom_line(mapping = aes(x = Jahr, y = Verbrauch, color = Energieträger))
d_ud <- read_excel("daten/beispiel-kodierung.xlsx", range="B2:D5")
kable(d_ud)
d_ud_k1 <- read_excel("daten/beispiel-kodierung.xlsx", range="F2:G5")
kable(d_ud_k1)
d_ud_k2 <- read_excel("daten/beispiel-kodierung.xlsx", range="I2:J5")
kable(d_ud_k2)
